# 浮动导航面板实现说明

## 功能特性

### ✅ 核心功能
1. **汉堡菜单按钮** - 左上角固定位置，点击展开/收起导航面板
2. **鼠标悬停交互** - 鼠标移到最左侧时自动展开，离开时自动收起
3. **文件夹层级导航** - 显示目录树结构，支持点击导航到不同文件夹
4. **智能延迟机制** - 展开延迟300ms，收起延迟500ms，避免误触发
5. **响应式设计** - 适配不同主题和屏幕尺寸

### ✅ 技术实现
1. **FloatingNavigationPanel.js** - 主要组件实现
2. **主进程集成** - 添加了 `scan-directory-tree` IPC 处理程序
3. **HomePage 集成** - 导入并使用浮动导航面板

## 组件架构

### FloatingNavigationPanel 组件
```jsx
<FloatingNavigationPanel
  currentPath={rootPath}
  onNavigate={handleNavigationPanelNavigate}
  rootPath={rootPath}
  isVisible={!!rootPath}
/>
```

#### Props
- `currentPath`: 当前路径，用于高亮显示
- `onNavigate`: 导航回调函数
- `rootPath`: 根路径
- `isVisible`: 是否显示面板

#### 交互逻辑
1. **点击汉堡菜单** - 切换 `isExpanded` 状态
2. **鼠标悬停** - 设置 `isHovered` 状态，带延迟
3. **面板显示** - `isExpanded || isHovered` 时显示
4. **文件夹展开** - 点击文件夹图标展开/收起子目录

## 主要文件修改

### 1. 新增组件文件
- `src/renderer/components/FloatingNavigationPanel.js` - 浮动导航面板组件

### 2. 主进程扩展
- `src/main/main.js` - 添加目录树扫描功能
  ```js
  // 新增 IPC 处理程序
  ipcMain.handle('scan-directory-tree', async (event, rootPath) => {
    const tree = await scanDirectoryTree(rootPath);
    return tree;
  });
  ```

### 3. HomePage 集成
- `src/renderer/pages/HomePage.js` - 集成浮动导航面板
  - 导入组件
  - 添加导航处理函数
  - 渲染导航面板

## 样式特性

### 视觉设计
- **浮动效果** - 使用 Material-UI Paper 组件，添加阴影
- **平滑动画** - CSS transition 实现 300ms 滑入/滑出效果
- **主题适配** - 支持深色/浅色模式
- **图标系统** - 使用 Material-UI 图标表示文件夹状态

### 定位布局
- **固定定位** - 相对于视口固定位置
- **z-index 层叠** - 确保浮动在其他内容之上
- **响应式宽度** - 面板宽度 280px，适配小屏幕

## 使用指南

### 基本操作
1. **展开导航** - 点击汉堡菜单图标或将鼠标移至最左侧
2. **收起导航** - 点击收起图标或将鼠标移离面板区域
3. **文件夹导航** - 点击文件夹名称导航到该目录
4. **展开子目录** - 点击文件夹右侧的展开/收起图标

### 智能特性
- **延迟机制** - 避免误触发，提供流畅的用户体验
- **状态记忆** - 手动点击的展开状态独立于悬停状态
- **路径显示** - 顶部显示当前根目录路径
- **滚动支持** - 长目录列表支持滚动浏览

## 开发调试

### 测试场景
1. 选择包含多层子目录的文件夹作为根目录
2. 测试汉堡菜单点击展开/收起
3. 测试鼠标悬停自动展开/收起
4. 测试文件夹点击导航功能
5. 测试子目录展开/收起功能

### 已知限制
1. 目录树默认扫描深度限制为 3 层，避免性能问题
2. 只显示包含图片或子目录的文件夹
3. 需要选择根路径后才会显示导航面板

## 技术细节

### 性能优化
- **延迟加载** - 目录树按需扫描，避免一次性加载过多数据
- **防抖处理** - 鼠标事件使用 setTimeout 实现防抖
- **内存管理** - 组件卸载时清理定时器

### 错误处理
- **路径验证** - 处理无法访问的文件夹
- **优雅降级** - 扫描失败时显示友好提示
- **异常恢复** - IPC 通信异常时不影响主要功能

这个实现提供了一个功能完整、用户友好的左侧浮动导航面板，支持汉堡菜单和鼠标悬停两种交互方式，能够有效帮助用户在不同层级的文件夹间快速导航。
# 照片相簿浏览器

一个功能丰富的跨平台桌面照片管理应用，专为浏览和管理大量照片相簿设计。智能穿透多层文件夹结构，自动识别相簿，并提供现代化的收藏管理和浏览体验。

## 🌟 主要功能

### 📁 智能相簿管理
- **穿透多层文件夹**: 自动查找最底层包含图片的文件夹作为相簿
- **智能识别**: 自动检测图片格式（JPG, PNG, GIF, WebP等）
- **元数据展示**: 显示相簿名称、图片数量、最后修改时间
- **快速预览**: 每个相簿显示4张预览图片

### ❤️ 收藏系统
- **相簿收藏**: 一键收藏整个相簿
- **单图收藏**: 单独收藏喜欢的图片
- **收藏集管理**: 创建自定义收藏集，分类管理内容
- **持久化存储**: 收藏数据本地保存，跨会话保持

### 🔍 高级浏览
- **多视图模式**: 网格视图、列表视图、详情视图
- **智能排序**: 按名称、图片数量、修改时间排序
- **快速搜索**: 实时搜索相簿和图片
- **响应式布局**: 自适应不同屏幕尺寸

### 🎯 图片查看器
- **全屏查看**: 支持全屏模式浏览
- **手势操作**: 鼠标滚轮缩放、拖拽平移
- **键盘导航**: 完整的快捷键列表请参见下文的“快捷键”章节。
- **触摸支持**: 移动设备友好的触摸操作

### 🎨 现代化界面
- **Material Design**: 遵循Google Material Design规范
- **深色主题**: 支持浅色/深色主题切换
- **动画效果**: 流畅的过渡动画和微交互
- **响应式设计**: 适配桌面和移动设备

## 🏛️ 架构 (Architecture)

经过重构，应用现在采用更现代化、更易于维护的架构。

### 后端 (Main Process)
- **服务化 (Service-Oriented)**: 核心的后台逻辑被拆分到独立的、单一职责的服务中，位于 `src/main/services` 目录。
  - `WindowService.js`: 管理应用的窗口创建和生命周期。
  - `FileSystemService.js`: 负责所有文件和目录的扫描与导航逻辑。
  - `ThumbnailService.js`: 处理所有缩略图的生成和缓存。
  - `FavoritesService.js`: 管理收藏夹的读写和文件监听。
- **调度中心**: `main.js` 作为IPC调度中心，负责路由前端请求到相应的服务，自身不包含具体业务逻辑。

### 前端 (Renderer Process)
- **组件化 (Component-Based)**: UI被拆分为可复用的React组件，位于 `src/renderer/components` 目录。
  - `PageLayout.js`: 统一所有页面的通用布局（顶栏、内容区等）。
  - `AlbumCard.js`, `ImageCard.js`: 列表和网格中的卡片单元。
  - `BreadcrumbNavigation.js`: 可复用的面包屑导航栏。
- **逻辑抽象 (Hook-Based)**: 重复的业务逻辑被抽象为自定义Hook，位于 `src/renderer/hooks` 目录。
  - `useSorting.js`: 封装了排序相关的状态和逻辑。
  - `useIsVisible.js`: 使用 `IntersectionObserver` 实现懒加载逻辑。

### 共享代码
- **`src/common`**: 该目录用于存放主进程和渲染器进程之间需要共享的代码，例如 `ipc-channels.js` 中定义的IPC通道名称常量。

## 🛠️ 技术栈

### 核心技术
- **Electron**: 跨平台桌面应用框架
- **React 18**: 现代化前端框架
- **Material-UI v5**: Google Material Design组件库
- **Webpack 5**: 模块打包和构建工具

### 性能优化
- **React.lazy**: 代码分割和懒加载
- **React.memo**: 组件级性能优化
- **虚拟滚动**: 大数据集高效渲染
- **图片懒加载**: 按需加载图片资源
- **缓存策略**: 智能缓存和预加载

### 开发工具
- **Babel**: JavaScript编译
- **CSS-in-JS**: Emotion样式系统
- **Sharp**: 高性能图片处理
- **Electron Builder**: 跨平台打包

## 🚀 快速开始

### 环境要求
- Node.js 16+
- npm 7+

### 安装与运行
```bash
# 克隆项目
git clone [repository-url]
cd photo-album-viewer

# 安装依赖
npm install

# 开发模式
npm start

# 构建生产版本
npm run build

# 打包应用
npm run build:electron
```

## ⌨️ 快捷键 (Keyboard Shortcuts)

为了提升浏览效率，应用内置了丰富的快捷键，根据当前视图分为三组：

### 1. 在图片查看器中 (打开单张大图时)

| 按键 | 功能 |
| :--- | :--- |
| `←` / `a` | 查看上一张图片 |
| `→` / `d` | 查看下一张图片 |
| `Esc` / `Backspace` | 关闭图片查看器 |
| `+` / `=` | 放大图片 |
| `-` / `_` | 缩小图片 |
| `Ctrl`+`鼠标滚轮` | 缩放图片 |
| `f` | 切换全屏模式 |
| `t` | 显示/隐藏顶部工具栏 |
| `o` | 在文件管理器中显示该图片 |
| `c` | 收藏/取消收藏当前图片 |
| `r` | 随机切换到另一张图片 |
| `q` | 向左旋转图片 |
| `e` | 向右旋转图片 |
| **鼠标右键** | 关闭图片查看器 |
| **鼠标中键** | 关闭图片查看器 |

### 2. 在相册页面 (查看图片缩略图时)

| 按键 | 功能 |
| :--- | :--- |
| `Esc` / `Backspace` | 返回上一级或上一页 |
| `h` | 返回主页 |
| `r` | 随机跳转到另一个相簿 |
| `←` | 切换到上一个相簿 |
| `→` | 切换到下一个相簿 |

### 3. 在主页/文件夹页面 (查看文件夹和相簿列表时)

| 按键 | 功能 |
| :--- | :--- |
| `Backspace` | 返回上一级 |
| `r` | 随机跳转到一个相簿 |

## 📦 构建版本

### 支持平台
- **Windows**: `.exe` 安装包
- **macOS**: `.dmg` 安装包
- **Linux**: `.AppImage` 可执行文件

### 构建命令
```bash
# 所有平台
npm run build

# 特定平台
npm run build:win     # Windows
npm run build:mac     # macOS  
npm run build:linux   # Linux
```

## 🎯 使用指南

### 初次使用
1. 启动应用，点击"选择文件夹"按钮
2. 选择包含照片的根文件夹
3. 应用自动扫描并显示所有相簿
4. 开始使用收藏和浏览功能

### 收藏管理
- **收藏相簿**: 点击相簿卡片上的心形图标
- **收藏图片**: 在图片查看器中点击收藏按钮
- **创建收藏集**: 在收藏页面点击"新建收藏集"
- **批量操作**: 支持多选和批量收藏

### 浏览技巧
- **快速导航**: 使用键盘快捷键或鼠标手势
- **缩放控制**: 滚轮缩放或双击切换
- **多图预览**: 悬停查看缩略图预览
- **拖拽排序**: 收藏集中拖拽排序项目

## ⚡ 性能特性

### 内存优化
- 智能缓存管理
- 按需加载图片
- 垃圾回收优化
- 内存泄漏防护

### 加载速度
- 并行文件夹扫描
- 图片预加载策略
- 压缩图片处理
- CDN资源加速

### 用户体验
- 渐进式加载
- 骨架屏占位
- 错误边界处理
- 离线功能支持

## 🔧 配置文件

### 应用设置
- 主题偏好（浅色/深色）
- 图片质量设置
- 缓存大小限制
- 快捷键自定义

### 数据存储
- 收藏数据：`~/.photo-album-viewer/favorites.json`
- 应用配置：`~/.photo-album-viewer/config.json`
- 缓存文件：`~/.photo-album-viewer/cache/`

## 🤝 贡献指南

我们欢迎任何形式的贡献！为了保持代码库的整洁和一致性，请在开始开发前仔细阅读我们的 **[贡献指南 (CONTRIBUTING.md)](CONTRIBUTING.md)**。

该指南包含了详细的开发规范、Git提交格式以及代码审查流程。

## 📄 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件

## 🙋‍♂️ 常见问题

**Q: 支持哪些图片格式？**
A: JPEG, PNG, GIF, WebP, BMP, TIFF等主流格式

**Q: 可以处理多大的图片？**
A: 支持任意大小，自动优化显示和内存使用

**Q: 收藏数据会丢失吗？**
A: 不会，数据本地持久化存储，支持备份恢复

**Q: 支持网络共享文件夹吗？**
A: 支持SMB、NFS等网络挂载的文件夹

---

**版本**: 2.0.0  
**更新日期**: 2025.09.28 